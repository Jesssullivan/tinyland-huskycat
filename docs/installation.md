# Installation Guide This guide covers installing HuskyCat locally and in development projects. ## Quick Start: Pre-Built Binaries (Recommended) The fastest way to get started is using pre-built binaries from GitLab releases. ### Download and Install **Linux (AMD64):** ```bash curl -L -o ~/.local/bin/huskycat https://gitlab.com/tinyland/ai/huskycat/-/releases/permalink/latest/downloads/huskycat-linux-amd64 chmod +x ~/.local/bin/huskycat ``` **Linux (ARM64):** ```bash curl -L -o ~/.local/bin/huskycat https://gitlab.com/tinyland/ai/huskycat/-/releases/permalink/latest/downloads/huskycat-linux-arm64 chmod +x ~/.local/bin/huskycat ``` **macOS (Apple Silicon):** ```bash mkdir -p ~/.local/bin curl -L -o ~/.local/bin/huskycat https://gitlab.com/tinyland/ai/huskycat/-/releases/permalink/latest/downloads/huskycat-darwin-arm64 chmod +x ~/.local/bin/huskycat ``` ### Verify Installation ```bash huskycat --version huskycat status ``` For detailed download instructions, platform-specific notes, and troubleshooting, see **[Binary Downloads Guide](binary-downloads.md)**. --- ## Prerequisites - **Container Runtime**: Podman or Docker (required for all validation) - **Python 3.8+**: For binary build and NPM mode - **UV Package Manager**: `pip install uv` - **Node.js and npm**: Build system - **Git Repository**: Required for hooks and staged file validation ## Alternative: Build from Source For development or platforms without pre-built binaries: ### Build from Source ```bash # Clone and build HuskyCat git clone <repository> cd huskycats-bates npm install # Install Python dependencies uv sync --dev # Build container (required for all validation) npm run container:build # Build binary entry point npm run build:binary # Verify installation ./dist/huskycat --version ./dist/huskycat status ``` ### Development Mode ```bash # For active development on HuskyCat itself npm run dev -- --help # Show available commands npm run validate # Validate current directory npm run hooks:install # Setup git hooks npm run mcp:server # Start MCP server ``` ## Using HuskyCat in Your Projects ### 1. Setup Git Hooks ```bash # Navigate to your project cd your-project # Setup HuskyCat git hooks ./path/to/huskycat setup-hooks # Test the installation git add . git commit -m "test: verify hooks" # Should run validation ``` ### 2. Validate Code ```bash # Validate current directory ./path/to/huskycat validate # Validate specific files ./path/to/huskycat validate src/main.py # Validate all files ./path/to/huskycat validate --all # Validate only staged files ./path/to/huskycat validate --staged ``` ## MCP Server Integration ### Setup MCP for Claude Code ```bash # Start MCP server for Claude Code integration (stdio mode) ./path/to/huskycat mcp-server # Or use the bootstrap command for automatic setup ./path/to/huskycat bootstrap ``` ### Claude Code Configuration Add to your Claude Code MCP configuration file: ```json { "mcpServers": { "huskycat": { "command": "/path/to/huskycat", "args": ["mcp-server"] } } } ``` **Note**: HuskyCat MCP server uses stdio protocol only (stdin/stdout). No ports are needed. ### Bootstrap Command The `bootstrap` command automates MCP configuration setup: ```bash # Automatically configure Claude Code MCP integration ./dist/huskycat bootstrap # Force overwrite existing configuration ./dist/huskycat bootstrap --force ``` This command: 1. Creates MCP configuration file with HuskyCat server 2. Configures the correct binary path 3. Sets up stdio transport ## Container-Based Execution HuskyCat uses containers for all validation to ensure consistency and isolation. The execution mode is automatically detected: ### Automatic Container Detection **On Host Machine:** - Requires Podman or Docker installed - Commands automatically wrapped in container execution - Tools run in isolated environment **Inside Container (CI/CD):** - Detects container environment automatically - Runs tools directly (no nested containers) - Optimized for pipeline performance ### Setup ```bash # Build validation container (required for host execution) npm run container:build # Test container works npm run container:test # All validation commands use appropriate execution mode ./dist/huskycat validate --all # Auto-detects: container or direct npm run validate # Auto-detects: container or direct ``` ### Container Detection HuskyCat automatically detects if it's running inside a container by checking: - `/.dockerenv` file (Docker) - `container` environment variable (Podman) - `/run/.containerenv` file (Podman) If no container runtime is detected on the host, HuskyCat will show an error and installation instructions for Podman or Docker. ## What Gets Configured HuskyCat setup creates: ``` your-project/ .git/hooks/ # Git hooks installed by setup-hooks pre-commit # Validates staged files pre-push # Validates CI configuration commit-msg # Validates commit message format .huskycat/ # Configuration and cache config.json # HuskyCat configuration schemas/ # Downloaded validation schemas (existing project files remain unchanged) ``` ## Post-Installation ### Verify Installation ```bash # Check HuskyCat status ./dist/huskycat status # Test validation ./dist/huskycat validate --all # Verify git hooks are working git add . git commit -m "test: verify hooks" # Should run validation # Update validation schemas ./dist/huskycat update-schemas ``` ### Using HuskyCat Commands After installation, you can use these commands: ```bash # Validate code ./dist/huskycat validate # Validate current directory ./dist/huskycat validate --staged # Validate staged files ./dist/huskycat validate src/main.py # Validate specific file # CI/CD validation ./dist/huskycat ci-validate .gitlab-ci.yml # Validate GitLab CI # MCP integration ./dist/huskycat mcp-server # Start MCP server # Management ./dist/huskycat clean # Clean cache ./dist/huskycat update-schemas # Update schemas ./dist/huskycat status # Show status ``` ## Development Configuration ### Configure Your IDE #### VS Code Add to `.vscode/settings.json`: ```json { "editor.formatOnSave": true, "python.formatting.provider": "black", "python.linting.enabled": true, "python.linting.flake8Enabled": true, "[python]": { "editor.codeActionsOnSave": { "source.organizeImports": true } } } ``` #### PyCharm 1. Go to Settings → Tools → File Watchers 2. Add watchers for Black and flake8 3. Enable "Reformat on Save" ### Update package.json Scripts Add these helpful scripts: ```json { "scripts": { "lint": "./scripts/comprehensive-lint.sh --all", "lint:fix": "./scripts/comprehensive-lint.sh --all --fix", "lint:staged": "./scripts/comprehensive-lint.sh --staged", "prepare": "husky install" } } ``` ## Troubleshooting ### Architecture Issues 1. **"exec format error" when running Docker** ```bash # This means architecture mismatch. Use the platform flag: docker run --rm --platform linux/amd64 -v "$(pwd):/workspace" \ registry.gitlab.com/tinyland/ai/huskycat/validator:latest # Or build the container locally: npm run container:build ``` 2. **Check your system architecture** ```bash # See what architecture you're running uname -m # x86_64 = use linux/amd64 # arm64 or aarch64 = use linux/arm64 # Check Docker image architecture docker inspect registry.gitlab.com/tinyland/ai/huskycat/validator:latest | grep Architecture ``` ### Common Issues 1. **"command not found" errors** - Ensure tools are installed and in PATH - Try using full paths in scripts 2. **Permission denied** - Make scripts executable: `chmod +x <script>` - Check file permissions 3. **Python tools not found** - Activate virtual environment - Install missing tools with pip 4. **Husky hooks not running** - Run `npx husky install` - Check Git version (needs 2.9+) - Ensure core.hooksPath is not set For additional support, see our [GitLab Issues](https://gitlab.com/tinyland/ai/huskycat/-/issues) page.
